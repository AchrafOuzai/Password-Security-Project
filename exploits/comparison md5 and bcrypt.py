#!/usr/bin/env python3
"""
Direct comparison script: MD5 vs bcrypt
Shows visually the security difference
"""

import hashlib
import bcrypt
import time
import os

def demo_md5_vulnerability():
    """Demonstration of MD5 vulnerability"""
    print("="*80)
    print("üîì DEMONSTRATION: MD5 Vulnerability")
    print("="*80)
    
    test_password = "password123"
    
    # MD5 Hash
    print(f"\n1. Creating MD5 hash for '{test_password}':")
    start = time.time()
    md5_hash = hashlib.md5(test_password.encode()).hexdigest()
    md5_time = time.time() - start
    print(f"   Hash: {md5_hash}")
    print(f"   Time: {md5_time*1000:.6f}ms")
    
    # Problem 1: Speed
    print(f"\n2. Speed test (1000 hashes):")
    start = time.time()
    for i in range(1000):
        hashlib.md5(f"test{i}".encode()).hexdigest()
    bulk_time = time.time() - start
    print(f"   Total time: {bulk_time:.4f}s")
    print(f"   Speed: {1000/bulk_time:.0f} hash/s")
    print(f"   ‚ö†Ô∏è  Too fast! Makes brute force easy")
    
    # Problem 2: No salt
    print(f"\n3. Salt issue:")
    user1_hash = hashlib.md5("samepassword".encode()).hexdigest()
    user2_hash = hashlib.md5("samepassword".encode()).hexdigest()
    print(f"   User 1: {user1_hash}")
    print(f"   User 2: {user2_hash}")
    print(f"   ‚ö†Ô∏è  Identical! Reveals common passwords")
    
    # Problem 3: Rainbow tables
    print(f"\n4. Vulnerable to rainbow tables:")
    print(f"   MD5 hash: {md5_hash}")
    print(f"   Searching on CrackStation.net...")
    print(f"   ‚ö†Ô∏è  Hash likely exists in precomputed tables")
    
    return md5_hash, md5_time

def demo_bcrypt_security():
    """Demonstration of bcrypt security"""
    print("\n" + "="*80)
    print("üîí DEMONSTRATION: bcrypt Security")
    print("="*80)
    
    test_password = "password123"
    
    # bcrypt Hash
    print(f"\n1. Creating bcrypt hash for '{test_password}':")
    start = time.time()
    bcrypt_hash = bcrypt.hashpw(test_password.encode(), bcrypt.gensalt(rounds=12))
    bcrypt_time = time.time() - start
    print(f"   Hash: {bcrypt_hash.decode()}")
    print(f"   Time: {bcrypt_time*1000:.2f}ms")
    
    # Advantage 1: Slowness
    print(f"\n2. Speed test (only 10 hashes, because it's slow):")
    start = time.time()
    for i in range(10):
        bcrypt.hashpw(f"test{i}".encode(), bcrypt.gensalt(rounds=12))
    bulk_time = time.time() - start
    print(f"   Total time: {bulk_time:.2f}s")
    print(f"   Speed: {10/bulk_time:.2f} hash/s")
    print(f"   ‚úÖ Intentionally slow! Protects against brute force")
    
    # Advantage 2: Unique salt
    print(f"\n3. Automatically unique salt:")
    user1_hash = bcrypt.hashpw("samepassword".encode(), bcrypt.gensalt(rounds=12))
    user2_hash = bcrypt.hashpw("samepassword".encode(), bcrypt.gensalt(rounds=12))
    print(f"   User 1: {user1_hash.decode()}")
    print(f"   User 2: {user2_hash.decode()}")
    print(f"   ‚úÖ Different! Unique salt per user")
    
    # Advantage 3: No rainbow tables
    print(f"\n4. Protection against rainbow tables:")
    print(f"   bcrypt hash: {bcrypt_hash.decode()}")
    print(f"   Embedded salt: {bcrypt_hash.decode().split('$')[3][:22]}")
    print(f"   ‚úÖ Rainbow tables USELESS (unique salt)")
    
    return bcrypt_hash.decode(), bcrypt_time

def calculate_cracking_estimates():
    """Calculate and compare cracking time estimates"""
    print("\n" + "="*80)
    print("üìä CRACKING TIME ESTIMATES")
    print("="*80)
    
    # Parameters
    wordlist_size = 14_344_391  # rockyou.txt
    
    print(f"\nWordlist: rockyou.txt ({wordlist_size:,} passwords)")
    print("\nHardware: Standard CPU (i5/i7)")
    
    # MD5
    print("\nüîì MD5 (no salt):")
    md5_speed = 1_000_000  # hash/s
    md5_time_seconds = wordlist_size / md5_speed
    print(f"   Speed: ~{md5_speed:,} hash/s")
    print(f"   Time for full wordlist: {md5_time_seconds:.1f}s (~{md5_time_seconds/60:.1f} minutes)")
    print(f"   ‚ö†Ô∏è  VERY FAST - Vulnerable!")
    
    # bcrypt
    print("\nüîí bcrypt (12 rounds):")
    bcrypt_speed = 3.5  # hash/s
    bcrypt_time_seconds = wordlist_size / bcrypt_speed
    bcrypt_time_days = bcrypt_time_seconds / 86400
    bcrypt_time_years = bcrypt_time_days / 365
    print(f"   Speed: ~{bcrypt_speed} hash/s")
    print(f"   Time for full wordlist:")
    print(f"     - Seconds: {bcrypt_time_seconds:,.0f}")
    print(f"     - Hours: {bcrypt_time_seconds/3600:,.0f}")
    print(f"     - Days: {bcrypt_time_days:,.1f}")
    print(f"     - Years: {bcrypt_time_years:,.1f}")
    print(f"   ‚úÖ VERY SLOW - Secure!")
    
    # Comparison
    print(f"\nüìà COMPARISON:")
    ratio = md5_speed / bcrypt_speed
    print(f"   bcrypt is {ratio:,.0f}x SLOWER than MD5")
    print(f"   That's exactly what we want!")
    
    # Economic cost
    print(f"\nüí∞ ECONOMIC COST OF CRACKING:")
    print(f"\n   MD5:")
    print(f"   - AWS c5.xlarge (GPU): ~$0.17/hour")
    print(f"   - Required time: <1 hour")
    print(f"   - Total cost: <$1")
    print(f"   ‚ö†Ô∏è  Economically VIABLE for an attacker")
    
    print(f"\n   bcrypt:")
    print(f"   - AWS c5.xlarge: ~$0.17/hour")
    print(f"   - Required time: {bcrypt_time_days:.0f} days")
    print(f"   - Total cost: ~${(bcrypt_time_days * 24 * 0.17):,.0f}")
    print(f"   ‚úÖ Economically NOT viable for an attacker")

def visual_comparison():
    """Visual comparison"""
    print("\n" + "="*80)
    print("üìä VISUAL COMPARISON")
    print("="*80)
    
    print("\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê")
    print("‚îÇ TIME TO CRACK A PASSWORD                                ‚îÇ")
    print("‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§")
    print("‚îÇ                                                         ‚îÇ")
    print("‚îÇ MD5:     [‚ñà] <1 second                                  ‚îÇ")
    print("‚îÇ                                                         ‚îÇ")
    print("‚îÇ bcrypt:  [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà]‚îÇ")
    print("‚îÇ          47+ days                                       ‚îÇ")
    print("‚îÇ                                                         ‚îÇ")
    print("‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò")
    
    print("\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê")
    print("‚îÇ RESISTANCE TO ATTACKS                                   ‚îÇ")
    print("‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§")
    print("‚îÇ                                                         ‚îÇ")
    print("‚îÇ MD5:                                                    ‚îÇ")
    print("‚îÇ   Brute Force:      ‚ùå Vulnerable                       ‚îÇ")
    print("‚îÇ   Rainbow Tables:   ‚ùå Vulnerable                       ‚îÇ")
    print("‚îÇ   Dictionary:       ‚ùå Vulnerable                       ‚îÇ")
    print("‚îÇ   GPU Acceleration: ‚ùå Very effective                   ‚îÇ")
    print("‚îÇ                                                         ‚îÇ")
    print("‚îÇ bcrypt:                                                 ‚îÇ")
    print("‚îÇ   Brute Force:      ‚úÖ Resistant                        ‚îÇ")
    print("‚îÇ   Rainbow Tables:   ‚úÖ Useless (unique salt)            ‚îÇ")
    print("‚îÇ   Dictionary:       ‚úÖ Resistant (slow)                 ‚îÇ")
    print("‚îÇ   GPU Acceleration: ‚úÖ Limited by design                ‚îÇ")
    print("‚îÇ                                                         ‚îÇ")
    print("‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò")

def practical_demonstration():
    """Practical demonstration with your real apps"""
    print("\n" + "="*80)
    print("üéØ PRACTICAL DEMONSTRATION")
    print("="*80)
    
    print("\nSteps to test with your applications:")
    print("\n1Ô∏è‚É£  Vulnerable Application (MD5):")
    print("   cd ../vulnerable_app")
    print("   python app.py")
    print("   ‚Üí Create test accounts")
    print("   ‚Üí Observe MD5 hashes in the dashboard")
    
    print("\n2Ô∏è‚É£  Extracting and Cracking MD5:")
    print("   cd ../exploits")
    print("   python extract_hashes.py")
    print("   python brute_force.py")
    print("   ‚Üí Observe: Cracking in <30 seconds!")
    
    print("\n3Ô∏è‚É£  Secure Application (bcrypt):")
    print("   cd ../secure_app")
    print("   python app.py")
    print("   ‚Üí Create accounts (strong passwords required)")
    print("   ‚Üí Observe: No visible hashes")
    
    print("\n4Ô∏è‚É£  Extracting and Attempting bcrypt Cracking:")
    print("   cd ../exploits")
    print("   python extract_hashes_secure.py")
    print("   python brute_force_bcrypt.py")
    print("   ‚Üí Observe: Very slow, likely no success")
    
    print("\n‚úÖ This demonstration proves:")
    print("   ‚Ä¢ MD5 is cracked in seconds")
    print("   ‚Ä¢ bcrypt resists for days/years")
    print("   ‚Ä¢ bcrypt slowness is a FEATURE, not a bug")

def main():
    """Main function"""
    print("\n")
    print("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
    print("‚ïë                                                                ‚ïë")
    print("‚ïë     SECURITY COMPARISON: MD5 vs bcrypt                         ‚ïë")
    print("‚ïë                                                                ‚ïë")
    print("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")
    
    # Demonstrations
    md5_hash, md5_time = demo_md5_vulnerability()
    bcrypt_hash, bcrypt_time = demo_bcrypt_security()
    
    # Speed ratio
    print("\n" + "="*80)
    print("‚ö° SPEED REPORT")
    print("="*80)
    print(f"\nHashing time:")
    print(f"   MD5:    {md5_time*1000:.6f}ms")
    print(f"   bcrypt: {bcrypt_time*1000:.2f}ms")
    print(f"\nbcrypt is {bcrypt_time/md5_time:.0f}x slower")
    print(f"(This is INTENTIONAL for security!)")
    
    # Estimates
    calculate_cracking_estimates()
    
    # Visual comparison
    visual_comparison()
    
    # Practical guide
    practical_demonstration()
    
    print("\n" + "="*80)
    print("üí° CONCLUSION")
    print("="*80)
    print("\nFor password storage:")
    print("  ‚ùå NEVER use: MD5, SHA-1, SHA-256 alone")
    print("  ‚úÖ ALWAYS use: bcrypt, Argon2, or scrypt")
    print("\nReason: Fast algorithms are vulnerable to brute force.")
    print("        Slow algorithms (bcrypt) protect against these attacks.")
    print("\n" + "="*80)

if __name__ == "__main__":
    main()
